"use strict";(self.webpackChunkcarbide_docs=self.webpackChunkcarbide_docs||[]).push([[7977],{1975:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var a=r(4848),s=r(8453);const i={},t="Installation",c={id:"classified-provisioning-docs/installation",title:"Installation",description:"Bundle Artifacts in Connected Environment",source:"@site/docs/classified-provisioning-docs/installation.md",sourceDirName:"classified-provisioning-docs",slug:"/classified-provisioning-docs/installation",permalink:"/carbide-docs/docs/classified-provisioning-docs/installation",draft:!1,unlisted:!1,editUrl:"https://github.com/rancherfederal/carbide-docs/edit/main/docs/classified-provisioning-docs/installation.md",tags:[],version:"current",frontMatter:{},sidebar:"carbideSidebar",previous:{title:"Prerequisites",permalink:"/carbide-docs/docs/classified-provisioning-docs/prereqs"},next:{title:"Provisioning Clusters",permalink:"/carbide-docs/docs/classified-provisioning-docs/usage"}},l={},d=[{value:"Bundle Artifacts in Connected Environment",id:"bundle-artifacts-in-connected-environment",level:2},{value:"Copy Files to Your Classified Registry",id:"copy-files-to-your-classified-registry",level:2},{value:"Rancher Government Helm Chart",id:"rancher-government-helm-chart",level:2},{value:"Upgrade Your Rancher Installation",id:"upgrade-your-rancher-installation",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,a.jsx)(n.h2,{id:"bundle-artifacts-in-connected-environment",children:"Bundle Artifacts in Connected Environment"}),"\n",(0,a.jsxs)(n.p,{children:["In a connected environment, utilize the ",(0,a.jsx)(n.code,{children:"Hauler"})," CLI to verify and collect the Rancher Government images and helm chart from the Carbide Secured Registry."]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Download the public key for Carbide."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"curl -sfL https://raw.githubusercontent.com/rancherfederal/carbide-releases/main/carbide-key.pub -o /tmp/carbide-key.pub\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Login into the Carbide registry with your Carbide Credentials, then validate and fetch the images to the local ",(0,a.jsx)(n.code,{children:"Hauler"})," store. Add the Rancher helm chart to your store, and save store as a tarball."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"hauler login rgcrprod.azurecr.us -u <redacted> -p <redacted>\nhauler store sync --products rancher-government=v2.10.3 --key carbide-key.pub\nhauler store add chart rancher --repo https://rancherfederal.github.io/carbide-charts --version 2.10.3\nhauler store save --filename rancher-govt.tar.zst\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Move the resulting ",(0,a.jsx)(n.code,{children:"rancher-govt.tar.zst"})," file into your airgapped/classified environment."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"copy-files-to-your-classified-registry",children:"Copy Files to Your Classified Registry"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Copy the ",(0,a.jsx)(n.code,{children:"rancher-govt.tar.zst"})," and the ",(0,a.jsx)(n.code,{children:"Hauler"})," binary to a server in your airgapped/classified environment. Please ensure ",(0,a.jsx)(n.code,{children:"Hauler"})," is added to your PATH."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Log in to your registry, load the bundle to the local store, and copy the images to your registry."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"hauler login <registry-url> -u <redacted> -p <redacted>\nhauler store load rancher-govt.tar.zst\nhauler store copy registry://<registry-url>\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"rancher-government-helm-chart",children:"Rancher Government Helm Chart"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Add and update the helm repository."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm repo add carbide-charts https://rancherfederal.github.io/carbide-charts\nhelm repo update carbide-charts\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Update the values for your environment and set the rancherImageTag with the ",(0,a.jsx)(n.code,{children:"-carbide-*"})," tag."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm install rancher carbide-charts/rancher \\\n--namespace cattle-system \\\n--set hostname=<rancher.my.org> \\\n--set bootstrapPassword=admin \\\n--set rancherImageTag=v2.10.3-carbide-1 \\\n--set carbide.whitelabel.enabled=false \\\n--version=v2.10.3\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"upgrade-your-rancher-installation",children:"Upgrade Your Rancher Installation"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Add and update the helm repository."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm repo add carbide-charts https://rancherfederal.github.io/carbide-charts\nhelm repo update carbide-charts\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Get existing values."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm get values -n cattle-system rancher > /tmp/values.yaml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Update values for your environment and set rancherImageTag with the ",(0,a.jsx)(n.code,{children:"-carbide-*"})," tag."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade rancher carbide-charts/rancher \\\n--namespace cattle-system \\\n-f /tmp/values.yaml \\\n--set rancherImageTag=v2.10.3-carbide-1 \\\n--set carbide.whitelabel.enabled=false \\\n--version=v2.10.3\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For more information about airgapped installation of Rancher, see the docs ",(0,a.jsx)(n.a,{href:"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/other-installation-methods/airgapped-helm-cli-install",children:"here"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var a=r(6540);const s={},i=a.createContext(s);function t(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);