"use strict";(self.webpackChunkcarbide_docs=self.webpackChunkcarbide_docs||[]).push([[774],{4644:(e,a,i)=>{i.r(a),i.d(a,{assets:()=>d,contentTitle:()=>n,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"registry-docs/validating-images","title":"Validating Images","description":"Images in the Caride Secured Registry (CSR) allow for signature validation and downloading artifacts with metadata about the image such as Software Bill of Materials (SBOMs), Vulnerability Scans, and Cryptographic Signatures.","source":"@site/docs/registry-docs/validating-images.md","sourceDirName":"registry-docs","slug":"/registry-docs/validating-images","permalink":"/carbide-docs/docs/registry-docs/validating-images","draft":false,"unlisted":false,"editUrl":"https://github.com/rancherfederal/carbide-docs/edit/main/docs/registry-docs/validating-images.md","tags":[],"version":"current","frontMatter":{},"sidebar":"carbideSidebar","previous":{"title":"Prerequisites","permalink":"/carbide-docs/docs/registry-docs/prereqs"},"next":{"title":"Copying Images to a Registry","permalink":"/carbide-docs/docs/registry-docs/copying-images"}}');var s=i(4848),c=i(8453);const t={},n="Validating Images",d={},l=[{value:"Secure Supply Chain",id:"secure-supply-chain",level:2},{value:"Display Supply Chain Artifacts",id:"display-supply-chain-artifacts",level:3},{value:"Verifying the Digital Signature",id:"verifying-the-digital-signature",level:3},{value:"Viewing the Software Bill of Materials",id:"viewing-the-software-bill-of-materials",level:3},{value:"Viewing the Vulnerability Scan Results",id:"viewing-the-vulnerability-scan-results",level:3},{value:"Display Supply Chain Artifacts",id:"display-supply-chain-artifacts-1",level:3},{value:"Verifying the Digital Signature",id:"verifying-the-digital-signature-1",level:3},{value:"Viewing the Software Bill of Materials",id:"viewing-the-software-bill-of-materials-1",level:3},{value:"Viewing the Vulnerability Scan Results",id:"viewing-the-vulnerability-scan-results-1",level:3},{value:"Resources",id:"resources",level:3}];function o(e){const a={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components},{Details:i}=a;return i||function(e,a){throw new Error("Expected "+(a?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"validating-images",children:"Validating Images"})}),"\n",(0,s.jsx)(a.p,{children:"Images in the Caride Secured Registry (CSR) allow for signature validation and downloading artifacts with metadata about the image such as Software Bill of Materials (SBOMs), Vulnerability Scans, and Cryptographic Signatures."}),"\n",(0,s.jsx)(a.p,{children:"This will guide you through validating the signatures and attestations of each image in the CSR."}),"\n",(0,s.jsx)(a.h2,{id:"secure-supply-chain",children:"Secure Supply Chain"}),"\n",(0,s.jsxs)(a.p,{children:["Before pulling images, or even after images have been pushed to a registry, you should always verify those images against the Carbide public key. Below are the instructions for using ",(0,s.jsx)(a.code,{children:"cosign"})," directly from a registry."]}),"\n",(0,s.jsxs)(a.p,{children:["If using ",(0,s.jsx)(a.code,{children:"Hauler"})," to seed your registry, Hauler will automatically verify the signatures when the public key is set in the manifest or as a flag with ",(0,s.jsx)(a.code,{children:"--key"}),"."]}),"\n",(0,s.jsxs)(a.blockquote,{children:["\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"NOTE:"})," You'll need to substitute ",(0,s.jsx)(a.code,{children:"rgcrprod.azurecr.us"})," with your own registry domain, if verifying images in your own registry."]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:["In Carbide Images v2 (or Cosign v2), the attachment of supply chain artifacts to the top layer of an image has been deprecated. In order to maintain interoperability, we have migrated our images and supply chain artifacts to be attached at the individual layer for a specific platform or architecture of an image. If you would like to see more information, please see the notice from cosign ",(0,s.jsx)(a.a,{href:"https://github.com/sigstore/cosign/blob/main/specs/SBOM_SPEC.md",children:"here"}),"."]}),"\n",(0,s.jsxs)(i,{open:!0,children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("b",{children:"Carbide Images v2"})," (After 03/2024)"]}),(0,s.jsx)(a.h3,{id:"display-supply-chain-artifacts",children:"Display Supply Chain Artifacts"}),(0,s.jsx)(a.p,{children:"View supply chain artifacts for an image:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign tree rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91\n"})}),(0,s.jsx)(a.p,{children:"Sample output for carbide-docs:0.1.4 for linux/amd64:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91\n\ud83d\udce6 Supply Chain Security Related artifacts for an image: rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91\n\u2514\u2500\u2500 \ud83d\udcbe Attestations for an image tag: rgcrprod.azurecr.us/carbide/carbide-docs:sha256-9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91.att\n   \u251c\u2500\u2500 \ud83c\udf52 sha256:dfa305431fecc7148b2975285295701a4e7e2f314bda41efa1fe4fb31758dc68\n   \u2514\u2500\u2500 \ud83c\udf52 sha256:133e5c020fe7fd20ae4453a9193a3b2a5e36a0447aa9d322ba83494bfde912d4\n\u2514\u2500\u2500 \ud83d\udd10 Signatures for an image tag: rgcrprod.azurecr.us/carbide/carbide-docs:sha256-9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91.sig\n   \u2514\u2500\u2500 \ud83c\udf52 sha256:f8cf6aea22f450991fc1800bc0b1440377a40833a94ff51c850210218fd5ad4d\n"})}),(0,s.jsx)(a.h3,{id:"verifying-the-digital-signature",children:"Verifying the Digital Signature"}),(0,s.jsx)(a.p,{children:"Verify the image's attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs:0.1.4 | jq\n"})}),(0,s.jsx)(a.h3,{id:"viewing-the-software-bill-of-materials",children:"Viewing the Software Bill of Materials"}),(0,s.jsx)(a.p,{children:"Verify the image's sbom attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91 --type spdxjson | jq\n"})}),(0,s.jsx)(a.p,{children:"View the image's SBOM:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91 --type spdxjson | jq -r '.payload' | base64 -d | jq\n"})}),(0,s.jsx)(a.h3,{id:"viewing-the-vulnerability-scan-results",children:"Viewing the Vulnerability Scan Results"}),(0,s.jsx)(a.p,{children:"Verify the image's vulnerability attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91 --type vuln | jq\n"})}),(0,s.jsx)(a.p,{children:"View the image's vulnerability scan results:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs@sha256:9cfda4875822b37f1e899c962e9bae5bb709235a1794834a839eaa74f429eb91 --type vuln | jq -r '.payload' | base64 -d | jq\n"})})]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("b",{children:"Carbide v1"})," (Before 03/2024)"]}),(0,s.jsx)(a.h3,{id:"display-supply-chain-artifacts-1",children:"Display Supply Chain Artifacts"}),(0,s.jsx)(a.p,{children:"Display supply chain related artifacts for an image:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign tree rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3\n"})}),(0,s.jsx)(a.p,{children:"Example output:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"\ud83d\udce6 Supply Chain Security Related artifacts for an image: rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3\n\u2514\u2500\u2500 \ud83d\udcbe Attestations for an image tag: rgcrprod.azurecr.us/carbide/carbide-docs:sha256-4d8b3e7e6e1a7640ca5f4ea833a5aef7a6f031947093e3e7625c8c949c1c8839.att\n   \u2514\u2500\u2500 \ud83c\udf52 sha256:8890d36772569483c9295be31a779770af0a61b51c6ba83cecc699fc724b9fd7\n\u2514\u2500\u2500 \ud83d\udd10 Signatures for an image tag: rgcrprod.azurecr.us/carbide/carbide-docs:sha256-4d8b3e7e6e1a7640ca5f4ea833a5aef7a6f031947093e3e7625c8c949c1c8839.sig\n   \u2514\u2500\u2500 \ud83c\udf52 sha256:a28126ae0a4bb23f71787e912125c25232677f6948812d937fd8feb9fe03ac6f\n\u2514\u2500\u2500 \ud83d\udce6 SBOMs for an image tag: rgcrprod.azurecr.us/carbide/carbide-docs:sha256-4d8b3e7e6e1a7640ca5f4ea833a5aef7a6f031947093e3e7625c8c949c1c8839.sbom\n   \u2514\u2500\u2500 \ud83c\udf52 sha256:970fc626b7075bd4822083cebc26d2e7cfcc1d5f1bfbcf9c3d0b3543a769be99\n"})}),(0,s.jsx)(a.h3,{id:"verifying-the-digital-signature-1",children:"Verifying the Digital Signature"}),(0,s.jsx)(a.p,{children:"Verify the image's attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3\n"})}),(0,s.jsx)(a.h3,{id:"viewing-the-software-bill-of-materials-1",children:"Viewing the Software Bill of Materials"}),(0,s.jsx)(a.p,{children:"Verify the image's SBOM attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3 --attachment sbom\n"})}),(0,s.jsx)(a.p,{children:"View the image's SBOM:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign download sbom rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3\n"})}),(0,s.jsx)(a.h3,{id:"viewing-the-vulnerability-scan-results-1",children:"Viewing the Vulnerability Scan Results"}),(0,s.jsx)(a.p,{children:"Verify the image's SBOM attestation by validating the supplied signature:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3 --type vuln | jq\n"})}),(0,s.jsx)(a.p,{children:"View the image's vulnerability scan results:"}),(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"cosign verify-attestation --key carbide-key.pub rgcrprod.azurecr.us/carbide/carbide-docs:0.1.3 --type vuln | jq -r '.payload' | base64 -d | jq\n"})})]}),"\n",(0,s.jsx)(a.h3,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(a.p,{children:["For more information on ",(0,s.jsx)(a.code,{children:"cosign"}),", check out the ",(0,s.jsx)(a.a,{href:"https://edu.chainguard.dev/open-source/sigstore/cosign/how-to-verify-file-signatures-with-cosign",children:"Chainguard Academy"}),"."]})]})}function h(e={}){const{wrapper:a}={...(0,c.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,a,i)=>{i.d(a,{R:()=>t,x:()=>n});var r=i(6540);const s={},c=r.createContext(s);function t(e){const a=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function n(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(c.Provider,{value:a},e.children)}}}]);