"use strict";(self.webpackChunkcarbide_docs=self.webpackChunkcarbide_docs||[]).push([[102],{4137:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=c(r),m=a,p=d["".concat(l,".").concat(m)]||d[m]||g[m]||i;return r?n.createElement(p,s(s({ref:t},u),{},{components:r})):n.createElement(p,s({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,s=new Array(i);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var c=2;c<i;c++)s[c]=r[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},3194:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>g,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var n=r(7462),a=(r(7294),r(4137));const i={},s="Rancher Manager Uninstall",o={unversionedId:"registry-docs/uninstall-rancher",id:"registry-docs/uninstall-rancher",title:"Rancher Manager Uninstall",description:"This page will walk you through how to uninstall Carbide Registry Images from Rancher Manager both for its own components and downstream Rancher Kubernetes clusters (RKE2/K3s).",source:"@site/docs/registry-docs/uninstall-rancher.md",sourceDirName:"registry-docs",slug:"/registry-docs/uninstall-rancher",permalink:"/carbide-docs/docs/registry-docs/uninstall-rancher",draft:!1,editUrl:"https://github.com/rancherfederal/carbide-docs/edit/main/docs/registry-docs/uninstall-rancher.md",tags:[],version:"current",frontMatter:{},sidebar:"carbideSidebar",previous:{title:"RKE2/K3s Uninstall",permalink:"/carbide-docs/docs/registry-docs/uninstall-kubernetes"},next:{title:"Carbide Helm Charts",permalink:"/carbide-docs/docs/carbide-charts"}},l={},c=[{value:"Reverting Cert Manager",id:"reverting-cert-manager",level:2},{value:"Using Your Own Registry",id:"using-your-own-registry",level:3},{value:"Using Docker Hub Images",id:"using-docker-hub-images",level:3},{value:"Registry Auth Scenarios",id:"registry-auth-scenarios",level:2},{value:"Global Registry",id:"global-registry",level:3},{value:"Uninstall Carbide Images on Rancher (Private Registry)",id:"uninstall-carbide-images-on-rancher-private-registry",level:4},{value:"Uninstall Carbide Images on Rancher (Docker Hub)",id:"uninstall-carbide-images-on-rancher-docker-hub",level:4},{value:"Reverting Downstream Clusters to use DockerHub Images",id:"reverting-downstream-clusters-to-use-dockerhub-images",level:4},{value:"Manual <code>registries.yaml</code> configuration (<code>RKE2</code>/<code>k3s</code>)",id:"manual-registriesyaml-configuration-rke2k3s",level:3},{value:"Reverting <code>Rancher</code> Chart",id:"reverting-rancher-chart",level:3}],u={toc:c};function g(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"rancher-manager-uninstall"},"Rancher Manager Uninstall"),(0,a.kt)("p",null,"This page will walk you through how to uninstall Carbide Registry Images from Rancher Manager both for its own components and downstream Rancher Kubernetes clusters (RKE2/K3s)."),(0,a.kt)("h2",{id:"reverting-cert-manager"},"Reverting Cert Manager"),(0,a.kt)("p",null,"As Rancher has a dependency on Cert Manager, you'll need to update your Helm install of Cert Manager to use the default images."),(0,a.kt)("h3",{id:"using-your-own-registry"},"Using Your Own Registry"),(0,a.kt)("p",null,"If using your own registry, you simply need to ",(0,a.kt)("a",{parentName:"p",href:"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/other-installation-methods/air-gapped-helm-cli-install/publish-images#2-collect-the-cert-manager-image"},"collect")," the necessary images for cert-manager and overwrite those images in your registry."),(0,a.kt)("p",null,"As pods cycle, the new image should propagate across the cluster."),(0,a.kt)("h3",{id:"using-docker-hub-images"},"Using Docker Hub Images"),(0,a.kt)("p",null,"If you want to go back to using Docker Hub images directly, you'll need to upgrade the cert-manager installation to revert pointing to the private registry hosting the Carbide images:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"helm install cert-manager jetstack/cert-manager \\\n  --namespace cert-manager \\\n  --create-namespace \\\n  --version v1.7.1\n")),(0,a.kt)("h2",{id:"registry-auth-scenarios"},"Registry Auth Scenarios"),(0,a.kt)("h3",{id:"global-registry"},"Global Registry"),(0,a.kt)("h4",{id:"uninstall-carbide-images-on-rancher-private-registry"},"Uninstall Carbide Images on Rancher (Private Registry)"),(0,a.kt)("p",null,"If using your own registry, you simply need to collect the necessary images for Rancher and overwrite those images in your registry."),(0,a.kt)("p",null,"As pods cycle, the new image should propagate across the cluster."),(0,a.kt)("h4",{id:"uninstall-carbide-images-on-rancher-docker-hub"},"Uninstall Carbide Images on Rancher (Docker Hub)"),(0,a.kt)("p",null,"If wanting to use upgrade Docker Hub images for Rancher:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Log into Rancher and configure the default administrator password."),(0,a.kt)("li",{parentName:"ol"},"Click ",(0,a.kt)("strong",{parentName:"li"},"\u2630 > Global Settings"),"."),(0,a.kt)("li",{parentName:"ol"},"Go to the setting called ",(0,a.kt)("inlineCode",{parentName:"li"},"system-default-registry")," and choose ",(0,a.kt)("strong",{parentName:"li"},"\u22ee > Edit Setting"),"."),(0,a.kt)("li",{parentName:"ol"},"Click the ",(0,a.kt)("inlineCode",{parentName:"li"},"Use the default value")," button.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Result:")," Rancher will use your private registry to pull system images."),(0,a.kt)("h4",{id:"reverting-downstream-clusters-to-use-dockerhub-images"},"Reverting Downstream Clusters to use DockerHub Images"),(0,a.kt)("p",null,"If you want to revert downstream RKE2/K3s clusters to use DockerHub images:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Click ",(0,a.kt)("strong",{parentName:"li"},"\u2630 > Cluster Management"),"."),(0,a.kt)("li",{parentName:"ol"},"On the ",(0,a.kt)("strong",{parentName:"li"},"Clusters")," page, select the 3-dot button to the right for downstream cluster you'd like to revert, and select ",(0,a.kt)("strong",{parentName:"li"},"Edit Config"),"."),(0,a.kt)("li",{parentName:"ol"},"."),(0,a.kt)("li",{parentName:"ol"},"In the ",(0,a.kt)("strong",{parentName:"li"},"Cluster Configuration")," go to the ",(0,a.kt)("strong",{parentName:"li"},"Registries")," tab and click ",(0,a.kt)("strong",{parentName:"li"},"Use default global registry for Rancher System Container Images"),"."),(0,a.kt)("li",{parentName:"ol"},"Click ",(0,a.kt)("strong",{parentName:"li"},"Save"),".")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Result:")," The cluster will update nodepools to use DockerHub images."),(0,a.kt)("h3",{id:"manual-registriesyaml-configuration-rke2k3s"},"Manual ",(0,a.kt)("inlineCode",{parentName:"h3"},"registries.yaml")," configuration (",(0,a.kt)("inlineCode",{parentName:"h3"},"RKE2"),"/",(0,a.kt)("inlineCode",{parentName:"h3"},"k3s"),")"),(0,a.kt)("p",null,"See the ",(0,a.kt)("a",{parentName:"p",href:"/carbide-docs/docs/registry-docs/uninstall-kubernetes"},"RKE2/K3s Uninstall")," documentation."),(0,a.kt)("h3",{id:"reverting-rancher-chart"},"Reverting ",(0,a.kt)("inlineCode",{parentName:"h3"},"Rancher")," Chart"),(0,a.kt)("p",null,"Follow Rancher's ",(0,a.kt)("a",{parentName:"p",href:"https://rancher.com/docs/rancher/v2.7/en/installation/install-rancher-on-k8s/"},"Installation Guide"),", you can revert to using DockerHub images by removing values from the Helm upgrade command."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"helm upgrade rancher rancher-latest/rancher \\\n  --namespace cattle-system \\\n  --set hostname=rancher.my.org \\\n  --set replicas=3\n")))}g.isMDXComponent=!0}}]);