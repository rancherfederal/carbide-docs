<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-registry-docs/configuration/rancher" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Rancher Configuration | Rancher Government Carbide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rancherfederal.github.io/carbide-docs/docs/registry-docs/configuration/rancher"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rancher Configuration | Rancher Government Carbide"><meta data-rh="true" name="description" content="This page will walk you through how to configure Rancher to use images from the CSR instead of the upstream Docker Hub images. This will apply to both its own components and downstream Rancher Kubernetes clusters (RKE2/K3s)."><meta data-rh="true" property="og:description" content="This page will walk you through how to configure Rancher to use images from the CSR instead of the upstream Docker Hub images. This will apply to both its own components and downstream Rancher Kubernetes clusters (RKE2/K3s)."><link data-rh="true" rel="icon" href="/carbide-docs/img/carbide-logo.ico"><link data-rh="true" rel="canonical" href="https://rancherfederal.github.io/carbide-docs/docs/registry-docs/configuration/rancher"><link data-rh="true" rel="alternate" href="https://rancherfederal.github.io/carbide-docs/docs/registry-docs/configuration/rancher" hreflang="en"><link data-rh="true" rel="alternate" href="https://rancherfederal.github.io/carbide-docs/docs/registry-docs/configuration/rancher" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Rancher Configuration","item":"https://rancherfederal.github.io/carbide-docs/docs/registry-docs/configuration/rancher"}]}</script><link rel="stylesheet" href="/carbide-docs/assets/css/styles.d6fda521.css">
<script src="/carbide-docs/assets/js/runtime~main.b5efdd5a.js" defer="defer"></script>
<script src="/carbide-docs/assets/js/main.7d506a6d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/carbide-docs/"><div class="navbar__logo"><img src="/carbide-docs/img/rancher_carbide_long_light_bg.svg" alt="Carbide Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/carbide-docs/img/rancher_carbide_long_light_bg.svg" alt="Carbide Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carbide-docs/docs/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://ranchergovernment.com/contact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contact Sales<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/rancherfederal/carbide-docs/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Submit Feedback<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbide-docs/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/carbide-docs/docs/registry-docs/introduction">Carbide Secured Registry (CSR)</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/release-cadence">Release Cadence</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/carbide-docs/docs/registry-docs/prereqs">Installation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/carbide-charts">Helm Charts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/carbide-docs/docs/registry-docs/configuration/kubernetes">Configuration</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/configuration/kubernetes">RKE2/k3s Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/carbide-docs/docs/registry-docs/configuration/rancher">Rancher Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/registry-docs/enforcement">Enforcement</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/carbide-docs/docs/registry-docs/uninstall-kubernetes">Uninstall</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/carbide-docs/docs/app-collection-docs/introduction">RGS Application Collection</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/app-collection-docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/app-collection-docs/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/app-collection-docs/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/app-collection-docs/appco-portal">AppCo Portal</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/carbide-docs/docs/IC-cloud-support-docs/introduction">IC Cloud Support</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/IC-cloud-support-docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/IC-cloud-support-docs/prereqs">Prerequisites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/IC-cloud-support-docs/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/IC-cloud-support-docs/usage">Provisioning Clusters</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/carbide-docs/docs/stigatron-docs/introduction">STIGATRON</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/stigatron-docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/carbide-docs/docs/stigatron-docs/prereqs">Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/carbide-docs/docs/stigatron-docs/create-scan">Using STIGATRON</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/stigatron-docs/uninstall">Uninstall</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/carbide-docs/docs/airgapped-docs/introduction">Airgapped Docs</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/airgapped-docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/carbide-docs/docs/airgapped-docs/prereqs">Installation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbide-docs/docs/airgapped-docs/uninstall">Uninstall</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbide-docs/docs/known-limits">Known Limitations &amp; Caveats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbide-docs/docs/feedback">Feedback</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/carbide-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Carbide Secured Registry (CSR)</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Configuration</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Rancher Configuration</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Rancher Configuration</h1></header>
<p>This page will walk you through how to configure Rancher to use images from the CSR instead of the upstream Docker Hub images. This will apply to both its own components and downstream Rancher Kubernetes clusters (RKE2/K3s).</p>
<blockquote>
<p><strong>NOTE</strong>: Due to current limitations of cloud providers, this project will not work for managing hosted clusters (AKS, EKS, GKE). If you&#x27;re currently using Rancher to manage those workloads, do not use this project. We intend to improve this experience in the future.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compatibility-matrix">Compatibility Matrix<a href="#compatibility-matrix" class="hash-link" aria-label="Direct link to Compatibility Matrix" title="Direct link to Compatibility Matrix">​</a></h2>
<table><thead><tr><th>Infra</th><th>Provisioner</th><th>Registry Auth Strategy</th><th>Test Status</th></tr></thead><tbody><tr><td>Any</td><td>Rancher (Cloud Provisioner)</td><td>Global Registry (Rancher)</td><td>Validated</td></tr><tr><td>Any</td><td>Rancher (Custom Provisioner)</td><td>Authenticated Registry (Manual registries.yaml)</td><td>Validated</td></tr><tr><td>Any</td><td>Self Installation</td><td>Global Registry (Rancher)</td><td>Validated</td></tr><tr><td>Any</td><td>Imported Cluster</td><td>Unknown</td><td></td></tr><tr><td>AWS-EKS</td><td>Rancher</td><td>ECR (public or private)</td><td></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preliminary-setup">Preliminary Setup<a href="#preliminary-setup" class="hash-link" aria-label="Direct link to Preliminary Setup" title="Direct link to Preliminary Setup">​</a></h2>
<p>As Rancher has a dependency on Cert Manager, you&#x27;ll need to update/install Cert Manager with the images provided by the CSR.</p>
<p>If you&#x27;re following Rancher&#x27;s <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster#4-install-cert-manager" target="_blank" rel="noopener noreferrer">connected installation</a> instructions, you&#x27;ll need to follow the steps below to use the Carbide Secured Registry (CSR) images for cert-manager.</p>
<p>If using the <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/other-installation-methods/air-gapped-helm-cli-install/install-rancher-ha" target="_blank" rel="noopener noreferrer">airgapped installation</a> instructions, make sure you&#x27;ve pulled the images to your local/airgapped registry.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-cert-manager">Configuring Cert Manager<a href="#configuring-cert-manager" class="hash-link" aria-label="Direct link to Configuring Cert Manager" title="Direct link to Configuring Cert Manager">​</a></h3>
<p>Follow Rancher&#x27;s <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster#4-install-cert-manager" target="_blank" rel="noopener noreferrer">connected installation</a> instructions, but using the following steps instead of the <code>helm install</code> command from the docs.</p>
<p>After adding the Cert Manager repo and installing the CRDs, use the following to create a temporary <code>values.yaml</code> for your chart, subsituting your registry domain:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOT &gt; /tmp/values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  registry: &lt;registry-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repository: jetstack/cert-manager-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">webhook:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registry: &lt;registry-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repository: jetstack/cert-manager-webhook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cainjector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registry: &lt;registry-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repository: jetstack/cert-manager-cainjector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">startupapicheck:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registry: &lt;registry-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repository: jetstack/cert-manager-startupapicheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acmesolver:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registry: &lt;registry-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repository: jetstack/cert-manager-acmesolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOT</span><br></span></code></pre></div></div>
<p>Then use the following <code>helm install</code> command to use the images:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install cert-manager jetstack/cert-manager \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace cert-manager \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --create-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --version v1.14.4 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -f /tmp/values.yaml</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="registry-auth-strategies">Registry Auth Strategies<a href="#registry-auth-strategies" class="hash-link" aria-label="Direct link to Registry Auth Strategies" title="Direct link to Registry Auth Strategies">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="global-registry-rancher">Global Registry (Rancher)<a href="#global-registry-rancher" class="hash-link" aria-label="Direct link to Global Registry (Rancher)" title="Direct link to Global Registry (Rancher)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="existing-rancher-installations">Existing Rancher Installations<a href="#existing-rancher-installations" class="hash-link" aria-label="Direct link to Existing Rancher Installations" title="Direct link to Existing Rancher Installations">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="setting-a-private-registry-with-no-credentials-as-the-default-registry">Setting a Private Registry with No Credentials as the Default Registry<a href="#setting-a-private-registry-with-no-credentials-as-the-default-registry" class="hash-link" aria-label="Direct link to Setting a Private Registry with No Credentials as the Default Registry" title="Direct link to Setting a Private Registry with No Credentials as the Default Registry">​</a></h5>
<ol>
<li>Log into Rancher and configure the default administrator password.</li>
<li>Click <strong>☰ &gt; Global Settings</strong>.</li>
<li>Go to the setting called <code>system-default-registry</code> and choose <strong>⋮ &gt; Edit Setting</strong>.</li>
<li>Change the value to your registry (e.g. <code>registry.yourdomain.com:port</code>). Do not prefix the registry with <code>http://</code> or <code>https://</code>.</li>
</ol>
<p><strong>Result:</strong> Rancher will use your private registry to pull system images.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="setting-a-private-registry-with-credentials-when-deploying-a-cluster">Setting a Private Registry with Credentials when Deploying a Cluster<a href="#setting-a-private-registry-with-credentials-when-deploying-a-cluster" class="hash-link" aria-label="Direct link to Setting a Private Registry with Credentials when Deploying a Cluster" title="Direct link to Setting a Private Registry with Credentials when Deploying a Cluster">​</a></h5>
<p>You can follow these steps to configure a private registry when you create a cluster:</p>
<ol>
<li>Click <strong>☰ &gt; Cluster Management</strong>.</li>
<li>On the <code>Clusters</code> page, click <code>Create</code>.</li>
<li>Choose a cluster type.</li>
<li>In the <code>Cluster Configuration</code> go to the <code>Registries</code> tab and select <strong>Pull images for Rancher from a private registry</strong>.</li>
<li>Enter the registry hostname and credentials.</li>
<li>Click <code>Create</code>.</li>
</ol>
<p><strong>Result:</strong> The new cluster will be able to pull images from the private registry.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-rancher-installations">New Rancher Installations<a href="#new-rancher-installations" class="hash-link" aria-label="Direct link to New Rancher Installations" title="Direct link to New Rancher Installations">​</a></h4>
<p>Follow Rancher&#x27;s <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster" target="_blank" rel="noopener noreferrer">Installation Guide</a>, making sure to use the Carbide chart obtained in the previous <a href="/carbide-docs/docs/registry-docs/carbide-charts">helm chart</a> section.</p>
<p>When installing Rancher, to utilize the private registry, you&#x27;ll need to set the following values in your helm values:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install rancher carbide-charts/rancher \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace cattle-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set hostname=rancher.my.org \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set replicas=3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set rancherImage=&lt;registry-url&gt;/rancher/rancher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set systemDefaultRegistry=&lt;registry-url&gt;</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>NOTE:</strong> This requires configuring RKE2/K3s <code>registries.yaml</code> to work. See the <a href="/carbide-docs/docs/registry-docs/configuration/kubernetes">RKE2/K3s configuration</a> section for more details.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authenticated-registry-manual-registriesyaml">Authenticated Registry (Manual registries.yaml)<a href="#authenticated-registry-manual-registriesyaml" class="hash-link" aria-label="Direct link to Authenticated Registry (Manual registries.yaml)" title="Direct link to Authenticated Registry (Manual registries.yaml)">​</a></h3>
<p>See the <a href="/carbide-docs/docs/registry-docs/configuration/kubernetes">RKE2/K3s configuration</a> section for more details.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rancherfederal/carbide-docs/edit/main/docs/registry-docs/configuration/rancher.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/carbide-docs/docs/registry-docs/configuration/kubernetes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RKE2/k3s Configuration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/carbide-docs/docs/registry-docs/enforcement"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Enforcement</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#compatibility-matrix" class="table-of-contents__link toc-highlight">Compatibility Matrix</a></li><li><a href="#preliminary-setup" class="table-of-contents__link toc-highlight">Preliminary Setup</a><ul><li><a href="#configuring-cert-manager" class="table-of-contents__link toc-highlight">Configuring Cert Manager</a></li></ul></li><li><a href="#registry-auth-strategies" class="table-of-contents__link toc-highlight">Registry Auth Strategies</a><ul><li><a href="#global-registry-rancher" class="table-of-contents__link toc-highlight">Global Registry (Rancher)</a></li><li><a href="#authenticated-registry-manual-registriesyaml" class="table-of-contents__link toc-highlight">Authenticated Registry (Manual registries.yaml)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/carbide-docs/docs/registry-docs/introduction">Carbide Registry Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/carbide-docs/docs/stigatron-docs/introduction">STIGATRON Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/carbide-docs/docs/airgapped-docs/introduction">Airgapped Docs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://rancher.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/rancher" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://rancher-users.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rancher Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://ranchergovernment.com/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">RGS Blog</a></li><li class="footer__item"><a href="https://github.com/rancherfederal" target="_blank" rel="noopener noreferrer" class="footer__link-item">RGS GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://support.rancherfederal.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">RGS ZenDesk<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Rancher Government Solutions. All rights reserved.</div></div></div></footer></div>
</body>
</html>